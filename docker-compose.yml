version: "3.8"

services:
  app:
    build:
      context: .
    command: gunicorn booker.wsgi:application --bind 0.0.0.0:8000
    environment:
      APP_ALLOWED_HOSTS: ${ALLOWED_HOSTS}
      APP_CORS_ORIGIN_WHITELIST: ${CORS_ORIGIN_WHITELIST}
      APP_CSRF_TRUSTED_ORIGINS: ${CSRF_TRUSTED_ORIGINS}
      APP_DATABASE_URL: ${DATABASE_URL}
      APP_DEBUG: ${DEBUG:-False}
      APP_SECRET_KEY: ${SECRET_KEY}
      APP_B_CODE_LENGTH: ${B_CODE_LENGTH:-4}
      APP_B_DAYS_BETWEEN: ${B_DAYS_BETWEEN}
      APP_B_TOTAL_APARTMENTS: ${B_TOTAL_APARTMENTS}
    ports:
      - "${APP_SERVICE_PORT}:8000"
    networks:
      - shared_services
    volumes:
      - static_volume:/code/static
      - media_volume:/code/media

networks:
  shared_services:
    external: true

volumes:
  static_volume:
  media_volume:
